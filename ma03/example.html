{% extends "base.html" %}
{% block content %}
<style>
    /* 進捗ボタン 130x50 */
    .step-navigation { display: flex; gap: 10px; align-items: center; justify-content: center; margin-bottom: 30px; }
    .step-navigation .step-item {
        width: 130px !important; height: 50px !important; display: flex; align-items: center; justify-content: center;
        border-radius: 25px; font-weight: bold; text-decoration: none; color: #666; background-color: #f8fafc; border: 1px solid #e2e8f0;
    }
    .step-navigation .step-item.active { background-color: #dbeafe !important; color: #1e40af !important; border: 2px solid #3b82f6 !important; }

    /* 入力ボックス */
    input[type="number"] {
        font-size: 28px !important; font-weight: 900 !important; color: #1e40af !important;
        height: 55px !important; width: 80px !important; text-align: center !important;
        border: 2px solid #3b82f6 !important; border-radius: 8px !important;
    }
    .fraction { display: inline-flex; flex-direction: column; align-items: center; vertical-align: middle; font-size: 1.8em; }
    .fraction-line { border-top: 2px solid #333; width: 100%; min-width: 50px; margin: 3px 0; }
    
    /* 正解・不正解アニメーション */
    .result-msg { font-size: 1.5em; font-weight: bold; margin-left: 15px; display: none; }
    .correct { color: #ef4444; }
    .incorrect { color: #3b82f6; }

    /* 解説モーダル */
    .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
    .modal-content { background-color: white; margin: 15% auto; padding: 25px; border-radius: 15px; width: 400px; position: relative; }
</style>

<div class="page-container">
    <h1>MA03 分数をたす・ひく 【② 例題】</h1>

    <div class="step-navigation">
        <a href="{{ url_for('math_unit_page', unit_code='MA03', page='intro') }}" class="step-item">① 導入</a>
        <div class="step-item active">② 例題</div>
        <a href="{{ url_for('math_unit_page', unit_code='MA03', page='drill') }}" class="step-item">③ 演習</a>
        <a href="{{ url_for('math_unit_page', unit_code='MA03', page='check') }}" class="step-item">④ 確認</a>
    </div>

    <p style="background: #fffbeb; padding: 15px; border-radius: 8px; border-left: 5px solid #f59e0b; font-size: 1.1em; margin-bottom: 25px;">
        <strong>【例題に挑戦】</strong> 導入で学んだルールを使って、下の問題を解いてみよう！
    </p>

    <div class="problem-box" style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #e2e8f0;">
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center;">
                <span style="font-weight: bold; margin-right: 15px;">(1)</span>
                <span class="fraction"><span>1</span><div class="fraction-line"></div><span>5</span></span>
                <span style="margin: 0 10px;">＋</span>
                <span class="fraction"><span>3</span><div class="fraction-line"></div><span>5</span></span>
                <span style="margin: 0 10px;">＝</span>
                <span class="fraction">
                    <span><input type="number" id="ex1_n"></span>
                    <div class="fraction-line"></div>
                    <span><input type="number" id="ex1_d"></span>
                </span>
                <span id="res1" class="result-msg"></span>
            </div>
            <button type="button" onclick="checkExample(1, 4, 5)" style="background:#3b82f6; color:white; border:none; padding:10px 20px; border-radius:10px; cursor:pointer; font-weight:bold;">判定</button>
        </div>
        <button type="button" onclick="showModal('m1')" style="margin-top:15px; background:none; border:none; color:#10b981; text-decoration:underline; cursor:pointer;">解き方のヒントを見る</button>
    </div>

    <div class="problem-box" style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 30px; border: 1px solid #e2e8f0;">
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center;">
                <span style="font-weight: bold; margin-right: 15px;">(2)</span>
                <span class="fraction"><span>4</span><div class="fraction-line"></div><span>7</span></span>
                <span style="margin: 0 10px;">－</span>
                <span class="fraction"><span>1</span><div class="fraction-line"></div><span>7</span></span>
                <span style="margin: 0 10px;">＝</span>
                <span class="fraction">
                    <span><input type="number" id="ex2_n"></span>
                    <div class="fraction-line"></div>
                    <span><input type="number" id="ex2_d"></span>
                </span>
                <span id="res2" class="result-msg"></span>
            </div>
            <button type="button" onclick="checkExample(2, 3, 7)" style="background:#3b82f6; color:white; border:none; padding:10px 20px; border-radius:10px; cursor:pointer; font-weight:bold;">判定</button>
        </div>
        <button type="button" onclick="showModal('m2')" style="margin-top:15px; background:none; border:none; color:#10b981; text-decoration:underline; cursor:pointer;">解き方のヒントを見る</button>
    </div>

    <div id="m1" class="modal"><div class="modal-content">
        <h3>(1) の解説</h3>
        <p>分母は <strong>5</strong> のまま。<br>分子は 1 ＋ 3 ＝ <strong>4</strong> です。<br>答えは 4/5 です！</p>
        <button onclick="closeModal('m1')">とじる</button>
    </div></div>

    <div id="m2" class="modal"><div class="modal-content">
        <h3>(2) の解説</h3>
        <p>分母は <strong>7</strong> のまま。<br>分子は 4 － 1 ＝ <strong>3</strong> です。<br>答えは 3/7 です！</p>
        <button onclick="closeModal('m2')">とじる</button>
    </div></div>

    <div style="text-align: center;">
        <a href="{{ url_for('math_unit_page', unit_code='MA03', page='drill') }}" class="btn btn-primary" style="padding: 15px 80px; border-radius: 50px; text-decoration: none; font-weight: bold; background-color: #10b981; color: white; display: inline-block;">練習（演習）に進む！ →</a>
    </div>
</div>

<script>
function checkExample(num, ansN, ansD) {
    const userN = document.getElementById('ex' + num + '_n').value;
    const userD = document.getElementById('ex' + num + '_d').value;
    const res = document.getElementById('res' + num);
    res.style.display = 'inline';
    if(parseInt(userN) === ansN && parseInt(userD) === ansD) {
        res.innerHTML = '〇 正解！';
        res.className = 'result-msg correct';
    } else {
        res.innerHTML = '× ざんねん！';
        res.className = 'result-msg incorrect';
    }
}
function showModal(id) { document.getElementById(id).style.display = "block"; }
function closeModal(id) { document.getElementById(id).style.display = "none"; }
</script>
{% endblock %}